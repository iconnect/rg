#!/usr/bin/env bash

configs="default"

doc() {
  case $1 in
    'default') echo 'default config: all dependencies from Hackage';;
    *) echo 'no-config';;
  esac
}

usage() {
  echo "usage: $0 [--help|--info|info|<config>]"
}

info() {
  local c
  for c in ${configs}; do
    printf "%-25s | %s\n" "${c}" "$(doc "${c}")"
  done
}

check() {
  i=$(doc "$1")
  echo "I = ${i}"
  if [ "${i}" = "no-config" ]; then
    echo "$0: $1: no such configuration"
    exit 1
  fi
}

if [ $# -gt 1 ]; then
  usage
  exit 1
fi

if [ $# -eq 0 ]; then
  cfg=default
else
  case $1 in
    --help)      usage; exit 0;;
    --info|info) info;  exit 0;;
    *)           cfg=$1; check "${cfg}";;
  esac
fi

dir=apollo/canned/${cfg}

if [ ! -d "${dir}" ]; then
  echo "${cfg}: configuration not found"
  exit 1;
fi

for f in "${dir}"/*; do
  echo "retrieving: $f"
  cp -f "${f}" .
done
